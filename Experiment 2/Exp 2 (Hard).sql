CREATE DATABASE EXP2;
USE EXP2;

CREATE TABLE YEAR_TBL (
	ID INT,
	YEAR INT,
	NPV INT,
);

CREATE TABLE QUERIES_TBL (
	ID INT,
	YEAR INT
);

INSERT INTO YEAR_TBL (ID, YEAR, NPV) VALUES
(101, 2018, 100000),
(102, 2020, 30000),
(103, 2019, 40000),
(101, 2019, 113000),
(104, 2018, 121000),
(105, 2019, 12000),
(106, 2020, 99000),
(102, 2019, 0);

INSERT INTO QUERIES_TBL (ID, YEAR) VALUES
(101, 2019),
(104, 2018),
(105, 2019),
(102, 2018),
(102, 2019),
(102, 2020),
(103, 2019);

-- SELECT the queries project IDs, Years and corresponding NPV, 0 by default.
SELECT
	Q.ID AS [Project ID],
	Q.Year AS "Year",
	ISNULL(Y.NPV, 0) AS NPV
FROM
	QUERIES_TBL AS Q
LEFT JOIN
	YEAR_TBL AS Y
ON
	Q.ID = Y.ID AND Q.YEAR = Y.YEAR
ORDER BY
	Q.ID;